{% extends 'topic.html' %}

{% block content %}
  <h2>{{ title }}</h2>
  <h2>{{ data_url }}</h2>

    {% load static %}

    <script src="{% static "english/js/sound.js" %}"></script>
    <script src="{% static "english/js/irregular.js" %}"></script>
    <input id="modeid" type="button" onclick="save(this)" mode='view' value="edit">
    <div id="playAll"></div>
    <table id="table1" cellpadding="0" cellspacing="0"></table>

    <script>
        document.onreadystatechange = function () {
            if (document.readyState == "complete") {
                loadpage('view');
            }
        }
        function save(self) {
            let mode = self.getAttribute('mode');
            if (mode == 'edit') {
                saveSettings('/eng/irregular/{{ user_id }}/?dir=save', function (data) {
                    clear()
                    loadpage('view');
                });
                self.setAttribute('mode', 'view')
                self.value = 'Edit'
            } else {
                self.setAttribute('mode', 'edit')
                self.value = 'Save'
                clear()
                loadpage('edit');
            }
        }
        function loadpage(mode) {
                let jsound = "{{ sound_url }}";
                let jmeta_sound = "{{ meta_sound_url }}";
                let startImgName = "{% static 'english/img/play-start.png' %}";
                let stopImgName = "{% static 'english/img/play-stop.png' %}";
                let qsettings = '/eng/irregular/{{ user_id }}/?dir=read';
                loadPage(jsound, jmeta_sound, qsettings, startImgName, stopImgName, mode);
        }
        function clear() {
            var el = document.getElementById("table1");
            while (el.hasChildNodes()) {
                el.removeChild(el.firstChild);
            }
            el = document.getElementById("playAll");
            while (el.hasChildNodes()) {
                el.removeChild(el.firstChild);
            }
        }
    </script>

{% endblock %}